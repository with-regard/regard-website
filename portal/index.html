<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Regard developer portal</title>
  <link rel="stylesheet" href="assets/css/main.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js"></script>
</head>
<body>
  
  <script type="text/x-handlebars" data-template-name="user-welcome" >
    <h1>User welcome template</h1>
  </script>
    
  <script type="text/x-handlebars" data-template-name="application">
    <div class="off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">
        <nav class="tab-bar">
          {{#unless isAnonymous}}
          <section class="left-small">
            <a class="left-off-canvas-toggle menu-icon" href="#"><span></span></a>
          </section>
          {{/unless}}

          <section class="middle tab-bar-section">
            <h1 class="title">{{outlet title}}</h1>
          </section>
          
          <section class="right-large">
            <div class="right">
              {{#if canEdit}}
                {{name}}
                <a href="/logout">Log out</a>
              {{else}}
                <a href="/login">Log in</a>
              {{/if}}
            </div>
          </section>
        </nav>

        <aside class="left-off-canvas-menu">
          <ul class="off-canvas-list">
            <li>
              <label>Projects 
                {{#if canEdit}}
                  <span class="label" {{action "createProject"}}>New</span>
                {{/if}}
              </label>
            </li>
            {{#each project in projects}}
              <li>
                {{#link-to 'project' project}}            
                  {{project.name}}
                  {{#if canEdit}}
                    <span class="right" {{action "deleteProject" project}}>&times;</span> 
                  {{/if}}
                {{/link-to}}
              </li>
            {{else}}
              You don't have any projects
            {{/each}}
          </ul>
        </aside>

        <section class="main-section">
          {{outlet}}
        </section>

        <a class="exit-off-canvas"></a>
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" data-template-name="project-title" >
    {{editable value=name editable=canEdit}}
  </script>
  
  <script type="text/x-handlebars" id="project">
    <ul class="left-side-nav">
      <li class="heading">Investigations {{#if canEdit}}<span class="secondary label" {{action "createInvestigation"}}>New</span>{{/if}}</li>
      {{#each investigation in investigations}}
        <li>
          {{#link-to 'investigation' investigation}}            
            {{investigation.name}}
            
            {{#if canEdit}}
              <a href="#" class="menu-actions" data-dropdown="investigation-actions">&hellip;</a>
              <ul id="investigation-actions" class="f-dropdown" data-dropdown-content>
                <li><a href="#" {{action "deleteInvestigation" investigation}}>Delete investigation</a></li>
              </ul>
            {{/if}}
          {{/link-to}}
        </li>  
      {{else}}
        <li class="muted">
          You haven't created any investigations yet.
        </li>
      {{/each}}
    </ul>  
      
    <div class="main-container">
      {{outlet}}
    </div>
  </script>
  
  <script type="text/x-handlebars" id="investigation">
    <div class="row full-width">
      <div class="medium-12 columns">
        <h2>{{editable value=name editable=canEdit}}</h2>
        
        {{outlet}}
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" id="investigation/index">
    {{#each chartdata in chartdata}}  
      {{bar-chart width=800 data=chartdata.values}}
    {{/each}}
  </script>
  
  <script type="text/x-handlebars" id="investigation/new">
    {{textarea value=queryDefinition rows="10" placeholder="Query definition"}}
    <button {{action 'createBarChart'}}>Create chart</button>
  </script>
      
  <script type="text/x-handlebars" id="projects/error">
    <div class="row pad">
      <div class="medium-6 medium-centered columns text-center">
        <h3>Project not found</h3>
        <p>This project may be private. If someone gave you this link, they may need to invite you to the project.</p>
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" id="investigation/error">
    <div class="row pad">
      <div class="medium-6 medium-centered columns text-center">
        <h3>Investigation not found</h3>
        <p>This investigation may be private. If someone gave you this link, they may need to invite you to the project.</p>
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" id="user/error">
    <div class="row pad">
      <div class="medium-6 medium-centered columns text-center">
        <h3>Failed to connect to API.</h3>
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" id="userevents">
    <div class="row pad">
      <div class="medium-12 medium-centered columns text-center">
        {{print-json events}}
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" id="projects/index">
    <div class="row pad">
      <div class="medium-12 medium-centered columns text-center">
        <img src="/assets/img/regard-logo-color.svg" height="200px" width="200px"/>
        <h1>Regard</h1>
        <p>Get answers to questions about a user's behavior and their environment.</p>
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" id="components/bar-chart">
    <g {{bind-attr transform=transformG}}>
      <g class="x axis" {{bind-attr transform=transformX}}></g>
      <g class="y axis" {{bind-attr transform=transformY}}></g>
      <g class="value axis"></g>
      <g class="chart"></g>
    </g>
  </script>
  
  <script src="portal/libs/jquery-1.10.2.js"></script>
  <script src="portal/libs/handlebars-1.1.2.js"></script>
  <script src="portal/libs/ember.js"></script>
  <script src="portal/libs/ember-data.js"></script>
  <script src="portal/libs/d3.min.js"></script>
  
  <script src="portal/app.js"></script>
  <script src="portal/router.js"></script>
  
  <script src="portal/controllers/AuthenticationController.js"></script>    
  <script src="portal/controllers/ApplicationController.js"></script>
  <script src="portal/controllers/ProjectController.js"></script>
  <script src="portal/controllers/InvestigationNewController.js"></script>
  
  <script src="portal/models/ProjectModel.js"></script>
  <script src="portal/models/InvestigationModel.js"></script>
  <script src="portal/models/UserModel.js"></script>
  <script src="portal/models/ChartDataModel.js"></script>
  <script src="portal/models/UserEventModel.js"></script>
  
  <script src="portal/components/BarChartComponent.js"></script>
  
  <script src="/assets/js/foundation.min.js"></script>
  <script src="/assets/js/main.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.0/fastclick.min.js"></script>
</body>
</html>